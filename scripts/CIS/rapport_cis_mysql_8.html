
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapport CIS MySQL 8.0 Benchmark</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <style>
        /* Styles personnalisés si nécessaire */
        .status-pass { color: #10B981; } /* green-500 */
        .status-fail { color: #EF4444; } /* red-500 */
        .status-manual { color: #F59E0B; } /* yellow-500 */
        .status-error { color: #6B7280; } /* gray-500 */
        .status-na { color: #9CA3AF; } /* gray-400 */
        pre { white-space: pre-wrap; word-wrap: break-word; background-color: #f3f4f6; padding: 0.5rem; border-radius: 0.25rem; font-size: 0.875rem;}
        table { table-layout: fixed; width: 100%; } /* Added for better column width control */
        td, th { word-break: break-word; } /* Allow breaking long words */
        .chart-container { width: 300px; height: 300px; margin: 20px auto; } /* Style for chart container */
        .category-chart-container { width: 80%; margin: 20px auto; } /* Style for category chart container */
        code { background-color: #e5e7eb; padding: 0.1rem 0.3rem; border-radius: 0.25rem; font-family: monospace;}
    </style>
</head>
<body class="font-sans bg-gray-100 text-gray-800 p-6">
    <div class="container mx-auto bg-white p-8 rounded-lg shadow-lg">
        <h1 class="text-3xl font-bold mb-6 text-gray-900">Rapport CIS MySQL 8.0 Benchmark</h1>
        <p class="text-gray-600 mb-4">Date du rapport : 28/04/2025 21:48:53</p>
        <p class="text-gray-600 mb-8">Généré par un script basé sur le document CIS MySQL 8.0 Benchmark (Version 1.0 du 13 Avril 2025 par Jean-Marie Renouard).</p>

        <div class="mb-8 p-4 bg-gray-50 rounded-md border border-gray-200">
            <h2 class="text-2xl font-semibold mb-3 text-gray-800">Score Global</h2>
            <p class="text-xl font-bold text-red-600">48.48%</p>
            <p class="text-gray-700">des contrôles automatisés réussis (16/33 vérifiés).</p>
             <p class="text-gray-700">37 contrôles nécessitent une vérification manuelle.</p>
             <p class="text-gray-700">0 contrôles ont rencontré une erreur d'exécution.</p>
             <p class="text-gray-700">0 contrôles ne sont pas applicables (ex: plugin non installé, commande introuvable).</p>

             <div class="chart-container">
                 <canvas id="overallScoreChart"></canvas>
             </div>
        </div>

        
        <div class="mb-10 p-4 bg-gray-50 rounded-md border border-gray-200">
            <h2 class="text-2xl font-semibold mb-3 text-gray-800">1. Configuration Système d&#x27;exploitation</h2>
            <p class="text-lg font-bold text-green-600">80.00%</p>
            <p class="text-gray-700">des contrôles automatisés réussis dans cette catégorie (4/5 vérifiés).</p>
            <p class="text-gray-700">2 contrôles nécessitent une vérification manuelle.</p>
            <p class="text-gray-700">0 contrôles ont rencontré une erreur d'exécution.</p>
            <p class="text-gray-700">0 contrôles ne sont pas applicables.</p>

            <table class="min-w-full border border-gray-300 divide-y divide-gray-300 mt-6">
                <thead>
                    <tr class="bg-gray-200 text-gray-700 uppercase text-sm leading-normal">
                        <th class="py-3 px-4 text-left w-1/12">Numéro</th>
                        <th class="py-3 px-4 text-left w-3/12">Recommandation</th>
                        <th class="py-3 px-4 text-left w-1/12">Type</th>
                        <th class="py-3 px-4 text-left w-2/12">Test Exécuté</th>
                        <th class="py-3 px-4 text-left w-1/12">Résultat</th>
                        <th class="py-3 px-4 text-left w-2/12">Sortie / Erreur / Notes</th>
                        <th class="py-3 px-4 text-left w-2/12">Procédure de Remédiation</th>
                    </tr>
                </thead>
                <tbody class="text-gray-600 text-sm font-light divide-y divide-gray-200">
                    
                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">1.1</td>
                        <td class="py-3 px-4 text-left align-top">Placer les bases de données sur des partitions non-système</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@datadir;&quot; puis vérifier avec df -h &lt;datadir&gt;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT @@datadir;&quot; puis vérifier avec df -h &lt;datadir&gt;</pre></td>
                        <td class="py-3 px-4 text-left align-top">Sauvegarder la base, déplacer les fichiers de données, mettre à jour datadir dans la configuration MySQL, redémarrer le service.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">1.2</td>
                        <td class="py-3 px-4 text-left align-top">Utiliser un compte dédié et privilégié minimal pour MySQL</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>ps -ef | grep mysqld | grep -v grep | awk &#x27;{print $1}&#x27;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
mysql
Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Configurer le service MySQL pour qu&#x27;il s&#x27;exécute sous un utilisateur dédié (ex: &#x27;mysql&#x27;) avec les privilèges minimaux.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">1.3</td>
                        <td class="py-3 px-4 text-left align-top">Désactiver l&#x27;historique des commandes MySQL</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>! find /home /root -name .mysql_history -print -quit 2&gt;/dev/null</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
/root/.mysql_history
Stderr:

Return Code: 1

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Supprimer les fichiers d&#x27;historique, créer un lien symbolique vers /dev/null, ou configurer MYSQL_HISTFILE.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">1.4</td>
                        <td class="py-3 px-4 text-left align-top">Vérifier que MYSQL_PWD n&#x27;est pas utilisé</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>! grep -qs MYSQL_PWD /proc/*/environ</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:

Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Modifier les scripts/utilisateurs pour éviter MYSQL_PWD, utiliser mysql_config_editor ou authentification certifiée.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">1.5</td>
                        <td class="py-3 px-4 text-left align-top">Désactiver l&#x27;accès interactif pour l&#x27;utilisateur MySQL</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>getent passwd mysql | cut -d: -f7</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
/bin/false
Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Modifier le shell de l&#x27;utilisateur mysql pour utiliser /bin/false ou /sbin/nologin (ex: usermod -s /sbin/nologin mysql).</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">1.6</td>
                        <td class="py-3 px-4 text-left align-top">Vérifier que MYSQL_PWD n&#x27;est pas dans les profils utilisateurs</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>! grep -qs MYSQL_PWD /home/*/.{bashrc,profile,bash_profile} /root/.{bashrc,profile,bash_profile} /etc/environment 2&gt;/dev/null</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:

Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Nettoyer les fichiers de login des utilisateurs pour supprimer MYSQL_PWD.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">1.7</td>
                        <td class="py-3 px-4 text-left align-top">Exécuter MySQL dans un environnement sandbox</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Vérifier si chroot, unité systemd spécifique, ou conteneurs Docker sont utilisés.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Vérifier si chroot, unité systemd spécifique, ou conteneurs Docker sont utilisés.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Configurer chroot, utiliser un service systemd avec un utilisateur spécifique, ou déployer MySQL sous Docker.</td>
                    </tr>

                </tbody>
            </table>
        </div>

        <div class="mb-10 p-4 bg-gray-50 rounded-md border border-gray-200">
            <h2 class="text-2xl font-semibold mb-3 text-gray-800">2. Installation et Planification</h2>
            <p class="text-lg font-bold text-green-600">100.00%</p>
            <p class="text-gray-700">des contrôles automatisés réussis dans cette catégorie (1/1 vérifiés).</p>
            <p class="text-gray-700">6 contrôles nécessitent une vérification manuelle.</p>
            <p class="text-gray-700">0 contrôles ont rencontré une erreur d'exécution.</p>
            <p class="text-gray-700">0 contrôles ne sont pas applicables.</p>

            <table class="min-w-full border border-gray-300 divide-y divide-gray-300 mt-6">
                <thead>
                    <tr class="bg-gray-200 text-gray-700 uppercase text-sm leading-normal">
                        <th class="py-3 px-4 text-left w-1/12">Numéro</th>
                        <th class="py-3 px-4 text-left w-3/12">Recommandation</th>
                        <th class="py-3 px-4 text-left w-1/12">Type</th>
                        <th class="py-3 px-4 text-left w-2/12">Test Exécuté</th>
                        <th class="py-3 px-4 text-left w-1/12">Résultat</th>
                        <th class="py-3 px-4 text-left w-2/12">Sortie / Erreur / Notes</th>
                        <th class="py-3 px-4 text-left w-2/12">Procédure de Remédiation</th>
                    </tr>
                </thead>
                <tbody class="text-gray-600 text-sm font-light divide-y divide-gray-200">
                    
                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">2.1.1</td>
                        <td class="py-3 px-4 text-left align-top">Politique de sauvegarde en place</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Vérifier crontab -l, les scripts de sauvegarde, ou la documentation interne.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Vérifier crontab -l, les scripts de sauvegarde, ou la documentation interne.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Créer une politique de sauvegarde et planifier des sauvegardes automatiques.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">2.1.2</td>
                        <td class="py-3 px-4 text-left align-top">Validation des sauvegardes</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Analyser les rapports de tests de restauration.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Analyser les rapports de tests de restauration.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Planifier et documenter les tests de restauration périodiques.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">2.1.3</td>
                        <td class="py-3 px-4 text-left align-top">Sécuriser les identifiants de sauvegarde</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Inspecter les permissions des fichiers contenant les credentials de sauvegarde.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Inspecter les permissions des fichiers contenant les credentials de sauvegarde.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Restreindre les droits fichiers, utiliser des keystores ou du chiffrement.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">2.1.4</td>
                        <td class="py-3 px-4 text-left align-top">Sécuriser les fichiers de sauvegarde</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Examiner les permissions et la présence de chiffrement sur les fichiers de sauvegarde.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Examiner les permissions et la présence de chiffrement sur les fichiers de sauvegarde.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Utiliser l&#x27;option --encrypt-password de MySQL Enterprise Backup ou une méthode de chiffrement équivalente.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">2.1.5</td>
                        <td class="py-3 px-4 text-left align-top">Point-in-Time Recovery</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@log_bin;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
1
Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Activer log_bin (log-bin=mysql-bin dans my.cnf), configurer l&#x27;expiration (expire_logs_days ou binlog_expire_logs_seconds), tester les restaurations PITR.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">2.1.6</td>
                        <td class="py-3 px-4 text-left align-top">Plan de reprise d&#x27;activité (DR)</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Vérifier l&#x27;existence et la validité du plan DR.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Vérifier l&#x27;existence et la validité du plan DR.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Documenter et tester un plan DR incluant réplication, backups offsite.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">2.1.7</td>
                        <td class="py-3 px-4 text-left align-top">Sauvegarde des fichiers de configuration</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Contrôler la liste des fichiers inclus dans la sauvegarde (my.cnf, clés SSL, etc.).</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Contrôler la liste des fichiers inclus dans la sauvegarde (my.cnf, clés SSL, etc.).</pre></td>
                        <td class="py-3 px-4 text-left align-top">Ajouter tous les fichiers essentiels à la stratégie de sauvegarde.</td>
                    </tr>

                </tbody>
            </table>
        </div>

        <div class="mb-10 p-4 bg-gray-50 rounded-md border border-gray-200">
            <h2 class="text-2xl font-semibold mb-3 text-gray-800">3. Permissions Fichiers</h2>
            <p class="text-lg font-bold text-yellow-600">50.00%</p>
            <p class="text-gray-700">des contrôles automatisés réussis dans cette catégorie (1/2 vérifiés).</p>
            <p class="text-gray-700">8 contrôles nécessitent une vérification manuelle.</p>
            <p class="text-gray-700">0 contrôles ont rencontré une erreur d'exécution.</p>
            <p class="text-gray-700">0 contrôles ne sont pas applicables.</p>

            <table class="min-w-full border border-gray-300 divide-y divide-gray-300 mt-6">
                <thead>
                    <tr class="bg-gray-200 text-gray-700 uppercase text-sm leading-normal">
                        <th class="py-3 px-4 text-left w-1/12">Numéro</th>
                        <th class="py-3 px-4 text-left w-3/12">Recommandation</th>
                        <th class="py-3 px-4 text-left w-1/12">Type</th>
                        <th class="py-3 px-4 text-left w-2/12">Test Exécuté</th>
                        <th class="py-3 px-4 text-left w-1/12">Résultat</th>
                        <th class="py-3 px-4 text-left w-2/12">Sortie / Erreur / Notes</th>
                        <th class="py-3 px-4 text-left w-2/12">Procédure de Remédiation</th>
                    </tr>
                </thead>
                <tbody class="text-gray-600 text-sm font-light divide-y divide-gray-200">
                    
                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">3.1</td>
                        <td class="py-3 px-4 text-left align-top">Permissions adéquates sur &#x27;datadir&#x27;</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>stat -c &#x27;%U:%G %a&#x27; /var/lib/mysql/</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
mysql:mysql 700
Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">chown -R mysql:mysql &lt;datadir&gt; &amp;&amp; chmod 700 &lt;datadir&gt;</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">3.2</td>
                        <td class="py-3 px-4 text-left align-top">Permissions sur les fichiers &#x27;log_bin_basename&#x27;</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@log_bin_basename;&quot; puis ls -l &lt;log_bin_basename&gt;*</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT @@log_bin_basename;&quot; puis ls -l &lt;log_bin_basename&gt;*</pre></td>
                        <td class="py-3 px-4 text-left align-top">Appliquer chmod 600 sur les fichiers binaires.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">3.3</td>
                        <td class="py-3 px-4 text-left align-top">Permissions sur &#x27;log_error&#x27;</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@log_error;&quot; puis ls -l &lt;log_error&gt;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT @@log_error;&quot; puis ls -l &lt;log_error&gt;</pre></td>
                        <td class="py-3 px-4 text-left align-top">Appliquer des permissions restrictives (ex: 640 ou 600).</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">3.4</td>
                        <td class="py-3 px-4 text-left align-top">Permissions sur &#x27;slow_query_log&#x27;</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@slow_query_log_file;&quot; puis ls -l &lt;slow_query_log_file&gt;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT @@slow_query_log_file;&quot; puis ls -l &lt;slow_query_log_file&gt;</pre></td>
                        <td class="py-3 px-4 text-left align-top">Limiter l&#x27;accès aux utilisateurs autorisés (ex: 640 ou 600).</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">3.5</td>
                        <td class="py-3 px-4 text-left align-top">Permissions sur &#x27;relay_log_basename&#x27;</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@relay_log_basename;&quot; puis ls -l &lt;relay_log_basename&gt;*</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT @@relay_log_basename;&quot; puis ls -l &lt;relay_log_basename&gt;*</pre></td>
                        <td class="py-3 px-4 text-left align-top">Appliquer chmod 600.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">3.6</td>
                        <td class="py-3 px-4 text-left align-top">Permissions sur &#x27;general_log_file&#x27;</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@general_log_file;&quot; puis ls -l &lt;general_log_file&gt;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT @@general_log_file;&quot; puis ls -l &lt;general_log_file&gt;</pre></td>
                        <td class="py-3 px-4 text-left align-top">Restreindre les droits d&#x27;accès (ex: 640 ou 600).</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">3.7</td>
                        <td class="py-3 px-4 text-left align-top">Permissions sur les fichiers de clés SSL</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Identifier les chemins des fichiers ssl_key, ssl_cert, ssl_ca dans my.cnf ou via SHOW VARIABLES, puis vérifier les permissions avec ls -l.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Identifier les chemins des fichiers ssl_key, ssl_cert, ssl_ca dans my.cnf ou via SHOW VARIABLES, puis vérifier les permissions avec ls -l.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Restreindre l&#x27;accès aux clés privées (ex: chmod 600) et s&#x27;assurer que le propriétaire est mysql.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">3.8</td>
                        <td class="py-3 px-4 text-left align-top">Permissions sur le répertoire des plugins</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>stat -c &#x27;%U:%G %a&#x27; /usr/lib/mysql/plugin/</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
root:root 755
Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">chown -R mysql:mysql &lt;plugin_dir&gt; &amp;&amp; chmod 755 &lt;plugin_dir&gt;</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">3.9</td>
                        <td class="py-3 px-4 text-left align-top">Permissions sur &#x27;audit_log_file&#x27;</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@audit_log_file;&quot; puis ls -l &lt;audit_log_file&gt;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT @@audit_log_file;&quot; puis ls -l &lt;audit_log_file&gt;</pre></td>
                        <td class="py-3 px-4 text-left align-top">Appliquer des permissions restrictives (ex: 640 ou 600).</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">3.10</td>
                        <td class="py-3 px-4 text-left align-top">Sécuriser le Keyring MySQL</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Vérifier les permissions du fichier keyring (si type &#x27;file&#x27;).</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Vérifier les permissions du fichier keyring (si type &#x27;file&#x27;).</pre></td>
                        <td class="py-3 px-4 text-left align-top">Chiffrer et restreindre l&#x27;accès au fichier keyring.</td>
                    </tr>

                </tbody>
            </table>
        </div>

        <div class="mb-10 p-4 bg-gray-50 rounded-md border border-gray-200">
            <h2 class="text-2xl font-semibold mb-3 text-gray-800">4. Général</h2>
            <p class="text-lg font-bold text-yellow-600">62.50%</p>
            <p class="text-gray-700">des contrôles automatisés réussis dans cette catégorie (5/8 vérifiés).</p>
            <p class="text-gray-700">2 contrôles nécessitent une vérification manuelle.</p>
            <p class="text-gray-700">0 contrôles ont rencontré une erreur d'exécution.</p>
            <p class="text-gray-700">0 contrôles ne sont pas applicables.</p>

            <table class="min-w-full border border-gray-300 divide-y divide-gray-300 mt-6">
                <thead>
                    <tr class="bg-gray-200 text-gray-700 uppercase text-sm leading-normal">
                        <th class="py-3 px-4 text-left w-1/12">Numéro</th>
                        <th class="py-3 px-4 text-left w-3/12">Recommandation</th>
                        <th class="py-3 px-4 text-left w-1/12">Type</th>
                        <th class="py-3 px-4 text-left w-2/12">Test Exécuté</th>
                        <th class="py-3 px-4 text-left w-1/12">Résultat</th>
                        <th class="py-3 px-4 text-left w-2/12">Sortie / Erreur / Notes</th>
                        <th class="py-3 px-4 text-left w-2/12">Procédure de Remédiation</th>
                    </tr>
                </thead>
                <tbody class="text-gray-600 text-sm font-light divide-y divide-gray-200">
                    
                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">4.1</td>
                        <td class="py-3 px-4 text-left align-top">Ensure the Latest Security Patches are Applied</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@version;&quot; puis comparer aux annonces Oracle/OS.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT @@version;&quot; puis comparer aux annonces Oracle/OS.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Installez les derniers correctifs pour votre version ou mettez à niveau vers la dernière version.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">4.2</td>
                        <td class="py-3 px-4 text-left align-top">Ensure Example or Test Databases are Not Installed on Production Servers</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT SCHEMA_NAME FROM information_schema.SCHEMATA WHERE SCHEMA_NAME IN (&#x27;employees&#x27;, &#x27;world&#x27;, &#x27;world_x&#x27;, &#x27;sakila&#x27;, &#x27;airportdb&#x27;, &#x27;menagerie&#x27;);&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
sakila
Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Exécutez DROP DATABASE &lt;database name&gt;; pour supprimer une base de données d&#x27;exemple.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">4.3</td>
                        <td class="py-3 px-4 text-left align-top">Ensure &#x27;allow-suspicious-udfs&#x27; is Set to &#x27;OFF&#x27;</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>my_print_defaults mysqld | grep -q &#x27;allow-suspicious-udfs&#x27; &amp;&amp; echo &#x27;FOUND&#x27; || echo &#x27;NOT FOUND&#x27;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
NOT FOUND
Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Supprimer --allow-suspicious-udfs de la ligne de commande ou du fichier de configuration.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">4.4</td>
                        <td class="py-3 px-4 text-left align-top">Harden Usage for &#x27;local_infile&#x27; on MySQL Clients</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@local_infile;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
0
Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Ajouter local-infile=0 à la section [mysqld] et [mysql] du fichier de configuration MySQL et redémarrer le service. Si nécessaire, utiliser --load-data-local-dir et TLS.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">4.5</td>
                        <td class="py-3 px-4 text-left align-top">Ensure &#x27;mysqld&#x27; is Not Started With &#x27;--skip-grant-tables&#x27;</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>ps -ef | grep mysqld | grep -v grep | grep -q &#x27;skip-grant-tables&#x27; &amp;&amp; echo &#x27;FOUND&#x27; || echo &#x27;NOT FOUND&#x27;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
NOT FOUND
Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Supprimer l&#x27;option --skip-grant-tables de la ligne de commande ou du fichier de configuration.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">4.6</td>
                        <td class="py-3 px-4 text-left align-top">Ensure Symbolic Links are Disabled</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@have_symlink;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
DISABLED
Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Ajouter skip-symbolic-links dans la section [mysqld] du fichier my.cnf.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">4.7</td>
                        <td class="py-3 px-4 text-left align-top">Ensure the &#x27;daemon_memcached&#x27; Plugin is Disabled</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT PLUGIN_STATUS FROM information_schema.plugins WHERE PLUGIN_NAME = &#x27;daemon_memcached&#x27;;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:

Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Exécutez UNINSTALL PLUGIN daemon_memcached;</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">4.8</td>
                        <td class="py-3 px-4 text-left align-top">Ensure the &#x27;secure_file_priv&#x27; is Configured Correctly</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@secure_file_priv;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
/var/lib/mysql-files/
Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Définir secure_file_priv sur NULL (pour désactiver) ou sur un chemin spécifique dans my.cnf.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">4.9</td>
                        <td class="py-3 px-4 text-left align-top">Ensure &#x27;sql_mode&#x27; Contains &#x27;STRICT_ALL_TABLES&#x27;</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@sql_mode;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION
Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Ajouter STRICT_ALL_TABLES au paramètre sql_mode dans my.cnf.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">4.10</td>
                        <td class="py-3 px-4 text-left align-top">Use MySQL TDE for At-Rest Data Encryption</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT TABLE_SCHEMA, TABLE_NAME, CREATE_OPTIONS FROM information_schema.TABLES WHERE CREATE_OPTIONS NOT LIKE &#x27;%ENCRYPTION=&quot;Y&quot;%&#x27; AND TABLE_SCHEMA NOT IN (&#x27;mysql&#x27;, &#x27;information_schema&#x27;, &#x27;performance_schema&#x27;, &#x27;sys&#x27;);&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT TABLE_SCHEMA, TABLE_NAME, CREATE_OPTIONS FROM information_schema.TABLES WHERE CREATE_OPTIONS NOT LIKE &#x27;%ENCRYPTION=&quot;Y&quot;%&#x27; AND TABLE_SCHEMA NOT IN (&#x27;mysql&#x27;, &#x27;information_schema&#x27;, &#x27;performance_schema&#x27;, &#x27;sys&#x27;);&quot;</pre></td>
                        <td class="py-3 px-4 text-left align-top">Activer le chiffrement pour les tables/tablespaces nécessaires via ALTER TABLE ... ENCRYPTION=&#x27;Y&#x27;;. Configurer le chiffrement pour les logs (binlog, redo, undo) et l&#x27;audit log si nécessaire.</td>
                    </tr>

                </tbody>
            </table>
        </div>

        <div class="mb-10 p-4 bg-gray-50 rounded-md border border-gray-200">
            <h2 class="text-2xl font-semibold mb-3 text-gray-800">5. Gestion des privilèges</h2>
            <p class="text-lg font-bold text-red-600">0.00%</p>
            <p class="text-gray-700">des contrôles automatisés réussis dans cette catégorie (0/6 vérifiés).</p>
            <p class="text-gray-700">6 contrôles nécessitent une vérification manuelle.</p>
            <p class="text-gray-700">0 contrôles ont rencontré une erreur d'exécution.</p>
            <p class="text-gray-700">0 contrôles ne sont pas applicables.</p>

            <table class="min-w-full border border-gray-300 divide-y divide-gray-300 mt-6">
                <thead>
                    <tr class="bg-gray-200 text-gray-700 uppercase text-sm leading-normal">
                        <th class="py-3 px-4 text-left w-1/12">Numéro</th>
                        <th class="py-3 px-4 text-left w-3/12">Recommandation</th>
                        <th class="py-3 px-4 text-left w-1/12">Type</th>
                        <th class="py-3 px-4 text-left w-2/12">Test Exécuté</th>
                        <th class="py-3 px-4 text-left w-1/12">Résultat</th>
                        <th class="py-3 px-4 text-left w-2/12">Sortie / Erreur / Notes</th>
                        <th class="py-3 px-4 text-left w-2/12">Procédure de Remédiation</th>
                    </tr>
                </thead>
                <tbody class="text-gray-600 text-sm font-light divide-y divide-gray-200">
                    
                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">5.1</td>
                        <td class="py-3 px-4 text-left align-top">Limiter l&#x27;accès complet à mysql.* aux seuls administrateurs</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT user, host FROM mysql.db WHERE db=&#x27;mysql&#x27; AND (Select_priv=&#x27;Y&#x27; OR Insert_priv=&#x27;Y&#x27; OR Update_priv=&#x27;Y&#x27; OR Delete_priv=&#x27;Y&#x27; OR Create_priv=&#x27;Y&#x27; OR Drop_priv=&#x27;Y&#x27; OR Alter_priv=&#x27;Y&#x27;);&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT user, host FROM mysql.db WHERE db=&#x27;mysql&#x27; AND (Select_priv=&#x27;Y&#x27; OR Insert_priv=&#x27;Y&#x27; OR Update_priv=&#x27;Y&#x27; OR Delete_priv=&#x27;Y&#x27; OR Create_priv=&#x27;Y&#x27; OR Drop_priv=&#x27;Y&#x27; OR Alter_priv=&#x27;Y&#x27;);&quot;</pre></td>
                        <td class="py-3 px-4 text-left align-top">Révoquer les privilèges excessifs sur la base &#x27;mysql&#x27; pour les utilisateurs non-administrateurs.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">5.2</td>
                        <td class="py-3 px-4 text-left align-top">Retirer le droit FILE aux non-admins</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT user, host FROM mysql.user WHERE File_priv = &#x27;Y&#x27;;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
debian-sys-maint	localhost
root	localhost
Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">REVOKE FILE ON *.* FROM &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">5.3</td>
                        <td class="py-3 px-4 text-left align-top">Retirer le droit PROCESS aux non-admins</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT user, host FROM mysql.user WHERE Process_priv = &#x27;Y&#x27;;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
debian-sys-maint	localhost
root	localhost
Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">REVOKE PROCESS ON *.* FROM &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">5.4</td>
                        <td class="py-3 px-4 text-left align-top">Retirer le droit SUPER (prérogative obsolète)</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT user, host FROM mysql.user WHERE Super_priv = &#x27;Y&#x27;;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
debian-sys-maint	localhost
mysql.session	localhost
root	localhost
Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Migrer vers les droits dynamiques (ex: BACKUP_ADMIN, REPLICATION_SLAVE_ADMIN) puis REVOKE SUPER ON *.* FROM &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">5.5</td>
                        <td class="py-3 px-4 text-left align-top">Retirer le droit SHUTDOWN</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT user, host FROM mysql.user WHERE Shutdown_priv = &#x27;Y&#x27;;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
debian-sys-maint	localhost
mysql.session	localhost
root	localhost
Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">REVOKE SHUTDOWN ON *.* FROM &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">5.6</td>
                        <td class="py-3 px-4 text-left align-top">Retirer CREATE USER aux non-admins</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT user, host FROM mysql.user WHERE Create_user_priv = &#x27;Y&#x27;;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
debian-sys-maint	localhost
root	localhost
Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">REVOKE CREATE USER ON *.* FROM &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">5.7</td>
                        <td class="py-3 px-4 text-left align-top">Retirer GRANT OPTION aux non-admins</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT user, host FROM mysql.user WHERE Grant_priv = &#x27;Y&#x27;;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
debian-sys-maint	localhost
root	localhost
Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">REVOKE GRANT OPTION ON *.* FROM &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">5.8</td>
                        <td class="py-3 px-4 text-left align-top">Limiter REPLICATION SLAVE aux comptes de réplication</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT user, host FROM mysql.user WHERE Repl_slave_priv = &#x27;Y&#x27;;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT user, host FROM mysql.user WHERE Repl_slave_priv = &#x27;Y&#x27;;&quot;</pre></td>
                        <td class="py-3 px-4 text-left align-top">REVOKE REPLICATION SLAVE ON *.* FROM les comptes non dédiés à la réplication.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">5.9</td>
                        <td class="py-3 px-4 text-left align-top">Limiter les droits DML/DDL à des BD/comptes précis</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Inspecter les privilèges via SHOW GRANTS FOR &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Inspecter les privilèges via SHOW GRANTS FOR &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;</pre></td>
                        <td class="py-3 px-4 text-left align-top">Révoquer les droits superflus par base de données/compte.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">5.10</td>
                        <td class="py-3 px-4 text-left align-top">Définir proprement DEFINER/INVOKER des SP/Functions</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT ROUTINE_SCHEMA, ROUTINE_NAME, DEFINER FROM information_schema.ROUTINES;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT ROUTINE_SCHEMA, ROUTINE_NAME, DEFINER FROM information_schema.ROUTINES;&quot;</pre></td>
                        <td class="py-3 px-4 text-left align-top">Recréer les routines avec un DEFINER minimal ou utiliser SQL SECURITY INVOKER.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">5.11</td>
                        <td class="py-3 px-4 text-left align-top">Restreindre le droit SET_ANY_DEFINER</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SHOW GRANTS FOR &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;&quot; et vérifier la présence de SET_ANY_DEFINER.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SHOW GRANTS FOR &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;&quot; et vérifier la présence de SET_ANY_DEFINER.</pre></td>
                        <td class="py-3 px-4 text-left align-top">REVOKE SET_ANY_DEFINER ON *.* FROM &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">5.12</td>
                        <td class="py-3 px-4 text-left align-top">Restreindre ALLOW_NONEXISTENT_DEFINER</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SHOW GRANTS FOR &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;&quot; et vérifier la présence de ALLOW_NONEXISTENT_DEFINER.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SHOW GRANTS FOR &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;&quot; et vérifier la présence de ALLOW_NONEXISTENT_DEFINER.</pre></td>
                        <td class="py-3 px-4 text-left align-top">REVOKE ALLOW_NONEXISTENT_DEFINER ON *.* FROM &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27;;</td>
                    </tr>

                </tbody>
            </table>
        </div>

        <div class="mb-10 p-4 bg-gray-50 rounded-md border border-gray-200">
            <h2 class="text-2xl font-semibold mb-3 text-gray-800">6. Audit &amp; Journalisation</h2>
            <p class="text-lg font-bold text-green-600">100.00%</p>
            <p class="text-gray-700">des contrôles automatisés réussis dans cette catégorie (2/2 vérifiés).</p>
            <p class="text-gray-700">6 contrôles nécessitent une vérification manuelle.</p>
            <p class="text-gray-700">0 contrôles ont rencontré une erreur d'exécution.</p>
            <p class="text-gray-700">0 contrôles ne sont pas applicables.</p>

            <table class="min-w-full border border-gray-300 divide-y divide-gray-300 mt-6">
                <thead>
                    <tr class="bg-gray-200 text-gray-700 uppercase text-sm leading-normal">
                        <th class="py-3 px-4 text-left w-1/12">Numéro</th>
                        <th class="py-3 px-4 text-left w-3/12">Recommandation</th>
                        <th class="py-3 px-4 text-left w-1/12">Type</th>
                        <th class="py-3 px-4 text-left w-2/12">Test Exécuté</th>
                        <th class="py-3 px-4 text-left w-1/12">Résultat</th>
                        <th class="py-3 px-4 text-left w-2/12">Sortie / Erreur / Notes</th>
                        <th class="py-3 px-4 text-left w-2/12">Procédure de Remédiation</th>
                    </tr>
                </thead>
                <tbody class="text-gray-600 text-sm font-light divide-y divide-gray-200">
                    
                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">6.1</td>
                        <td class="py-3 px-4 text-left align-top">Configurer log_error</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@log_error;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
/var/log/mysql/error.log
Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Définir log-error=/chemin/vers/mysql.err dans my.cnf.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">6.2</td>
                        <td class="py-3 px-4 text-left align-top">Journal hors partition système</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@log_bin_basename, @@log_error;&quot; puis vérifier les chemins avec df -h.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT @@log_bin_basename, @@log_error;&quot; puis vérifier les chemins avec df -h.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Déplacer les répertoires des journaux (log-bin, log-error) hors des partitions système.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">6.3</td>
                        <td class="py-3 px-4 text-left align-top">log_error_verbosity=2</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@log_error_verbosity;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
2
Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Ajouter log_error_verbosity=2 dans my.cnf.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">6.4</td>
                        <td class="py-3 px-4 text-left align-top">log-raw OFF</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Vérifier la présence de &#x27;log-raw&#x27; dans my.cnf.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Vérifier la présence de &#x27;log-raw&#x27; dans my.cnf.</pre></td>
                        <td class="py-3 px-4 text-left align-top">S&#x27;assurer que &#x27;log-raw&#x27; n&#x27;est pas activé ou est explicitement OFF dans my.cnf.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">6.5</td>
                        <td class="py-3 px-4 text-left align-top">Filtrer et journaliser les connexions</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Vérifier la configuration du plugin d&#x27;audit (ex: audit_log) pour la journalisation des connexions.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Vérifier la configuration du plugin d&#x27;audit (ex: audit_log) pour la journalisation des connexions.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Configurer le plugin d&#x27;audit pour journaliser les succès et échecs de connexion.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">6.6</td>
                        <td class="py-3 px-4 text-left align-top">Filtre &lt;&lt; tout journaliser &gt;&gt;</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Vérifier la configuration du plugin d&#x27;audit pour s&#x27;assurer qu&#x27;un filtre &#x27;log_all&#x27; ou équivalent est appliqué.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Vérifier la configuration du plugin d&#x27;audit pour s&#x27;assurer qu&#x27;un filtre &#x27;log_all&#x27; ou équivalent est appliqué.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Créer et appliquer un filtre d&#x27;audit pour journaliser toutes les actions.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">6.7</td>
                        <td class="py-3 px-4 text-left align-top">audit_log_strategy = (S)SYNC</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@audit_log_strategy;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT @@audit_log_strategy;&quot;</pre></td>
                        <td class="py-3 px-4 text-left align-top">Configurer audit_log_strategy=&#x27;SEMISYNCHRONOUS&#x27; ou &#x27;SYNCHRONOUS&#x27; via le plugin d&#x27;audit.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">6.8</td>
                        <td class="py-3 px-4 text-left align-top">Interdire le déchargement du plugin audit</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Vérifier si audit_log=FORCE_PLUS_PERMANENT est dans my.cnf.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Vérifier si audit_log=FORCE_PLUS_PERMANENT est dans my.cnf.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Ajouter audit_log=FORCE_PLUS_PERMANENT dans my.cnf.</td>
                    </tr>

                </tbody>
            </table>
        </div>

        <div class="mb-10 p-4 bg-gray-50 rounded-md border border-gray-200">
            <h2 class="text-2xl font-semibold mb-3 text-gray-800">7. Authentification</h2>
            <p class="text-lg font-bold text-red-600">40.00%</p>
            <p class="text-gray-700">des contrôles automatisés réussis dans cette catégorie (2/5 vérifiés).</p>
            <p class="text-gray-700">2 contrôles nécessitent une vérification manuelle.</p>
            <p class="text-gray-700">0 contrôles ont rencontré une erreur d'exécution.</p>
            <p class="text-gray-700">0 contrôles ne sont pas applicables.</p>

            <table class="min-w-full border border-gray-300 divide-y divide-gray-300 mt-6">
                <thead>
                    <tr class="bg-gray-200 text-gray-700 uppercase text-sm leading-normal">
                        <th class="py-3 px-4 text-left w-1/12">Numéro</th>
                        <th class="py-3 px-4 text-left w-3/12">Recommandation</th>
                        <th class="py-3 px-4 text-left w-1/12">Type</th>
                        <th class="py-3 px-4 text-left w-2/12">Test Exécuté</th>
                        <th class="py-3 px-4 text-left w-1/12">Résultat</th>
                        <th class="py-3 px-4 text-left w-2/12">Sortie / Erreur / Notes</th>
                        <th class="py-3 px-4 text-left w-2/12">Procédure de Remédiation</th>
                    </tr>
                </thead>
                <tbody class="text-gray-600 text-sm font-light divide-y divide-gray-200">
                    
                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">7.1</td>
                        <td class="py-3 px-4 text-left align-top">Plugin d&#x27;authentification sûr (caching_sha2_password)</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@default_authentication_plugin;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
caching_sha2_password
Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Définir default_authentication_plugin=caching_sha2_password dans my.cnf et migrer les comptes existants.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">7.2</td>
                        <td class="py-3 px-4 text-left align-top">Aucun mot de passe dans le my.cnf global</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Inspecter les fichiers my.cnf globaux (/etc/my.cnf, /etc/mysql/my.cnf, etc.) pour des mots de passe en clair.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Inspecter les fichiers my.cnf globaux (/etc/my.cnf, /etc/mysql/my.cnf, etc.) pour des mots de passe en clair.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Utiliser mysql_config_editor ou des fichiers .my.cnf privés avec permissions restreintes.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">7.3</td>
                        <td class="py-3 px-4 text-left align-top">Tous les comptes ont un mot de passe</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT user, host FROM mysql.user WHERE authentication_string = &#x27;&#x27; OR plugin=&#x27;mysql_no_login&#x27;;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
sakila_read	%
sakila_write	%
root	localhost
Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">ALTER USER &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27; IDENTIFIED BY &#x27;&lt;password&gt;&#x27;; ou utiliser mysql_secure_installation.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">7.4</td>
                        <td class="py-3 px-4 text-left align-top">Expiration annuelle des mots de passe</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@default_password_lifetime;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
0
Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">SET PERSIST default_password_lifetime=365;</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">7.5</td>
                        <td class="py-3 px-4 text-left align-top">Politique de complexité forte</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SHOW VARIABLES LIKE &#x27;validate_password%&#x27;;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SHOW VARIABLES LIKE &#x27;validate_password%&#x27;;&quot;</pre></td>
                        <td class="py-3 px-4 text-left align-top">Installer et configurer component_validate_password avec une politique forte (ex: validate_password.policy=STRONG).</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">7.6</td>
                        <td class="py-3 px-4 text-left align-top">Pas de wildcard &#x27;%&#x27; dans host</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT user, host FROM mysql.user WHERE host = &#x27;%&#x27;;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
sakila_read	%
sakila_write	%
Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">ALTER USER &#x27;&lt;user&gt;&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;...&#x27; RENAME TO &#x27;&lt;user&gt;&#x27;@&#x27;&lt;specific_host&gt;&#x27;; ou supprimer le compte.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">7.7</td>
                        <td class="py-3 px-4 text-left align-top">Supprimer les comptes anonymes</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT user, host FROM mysql.user WHERE user = &#x27;&#x27;;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:

Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">DROP USER &#x27;&#x27;@&#x27;&lt;host&gt;&#x27;; ou utiliser mysql_secure_installation.</td>
                    </tr>

                </tbody>
            </table>
        </div>

        <div class="mb-10 p-4 bg-gray-50 rounded-md border border-gray-200">
            <h2 class="text-2xl font-semibold mb-3 text-gray-800">8. Sécurité réseau</h2>
            <p class="text-lg font-bold text-red-600">0.00%</p>
            <p class="text-gray-700">des contrôles automatisés réussis dans cette catégorie (0/1 vérifiés).</p>
            <p class="text-gray-700">2 contrôles nécessitent une vérification manuelle.</p>
            <p class="text-gray-700">0 contrôles ont rencontré une erreur d'exécution.</p>
            <p class="text-gray-700">0 contrôles ne sont pas applicables.</p>

            <table class="min-w-full border border-gray-300 divide-y divide-gray-300 mt-6">
                <thead>
                    <tr class="bg-gray-200 text-gray-700 uppercase text-sm leading-normal">
                        <th class="py-3 px-4 text-left w-1/12">Numéro</th>
                        <th class="py-3 px-4 text-left w-3/12">Recommandation</th>
                        <th class="py-3 px-4 text-left w-1/12">Type</th>
                        <th class="py-3 px-4 text-left w-2/12">Test Exécuté</th>
                        <th class="py-3 px-4 text-left w-1/12">Résultat</th>
                        <th class="py-3 px-4 text-left w-2/12">Sortie / Erreur / Notes</th>
                        <th class="py-3 px-4 text-left w-2/12">Procédure de Remédiation</th>
                    </tr>
                </thead>
                <tbody class="text-gray-600 text-sm font-light divide-y divide-gray-200">
                    
                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">8.1</td>
                        <td class="py-3 px-4 text-left align-top">Forcer SSL/TLS (require_secure_transport=ON)</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@require_secure_transport;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
0
Stderr:

Return Code: 0

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Configurer les certificats SSL/TLS, puis ajouter require_secure_transport=ON dans my.cnf.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">8.2</td>
                        <td class="py-3 px-4 text-left align-top">Exiger TLS côté utilisateur (ssl_type)</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT user, host, ssl_type FROM mysql.user WHERE host NOT IN (&#x27;localhost&#x27;, &#x27;127.0.0.1&#x27;, &#x27;::1&#x27;);&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SELECT user, host, ssl_type FROM mysql.user WHERE host NOT IN (&#x27;localhost&#x27;, &#x27;127.0.0.1&#x27;, &#x27;::1&#x27;);&quot;</pre></td>
                        <td class="py-3 px-4 text-left align-top">ALTER USER &#x27;&lt;user&gt;&#x27;@&#x27;&lt;host&gt;&#x27; REQUIRE SSL; ou REQUIRE X509;</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">8.3</td>
                        <td class="py-3 px-4 text-left align-top">Limiter le nombre de connexions</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SHOW VARIABLES LIKE &#x27;max_connections&#x27;; SHOW VARIABLES LIKE &#x27;max_user_connections&#x27;;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
mysql -N -B -e &quot;SHOW VARIABLES LIKE &#x27;max_connections&#x27;; SHOW VARIABLES LIKE &#x27;max_user_connections&#x27;;&quot;</pre></td>
                        <td class="py-3 px-4 text-left align-top">Ajuster max_connections et max_user_connections dans my.cnf selon les besoins.</td>
                    </tr>

                </tbody>
            </table>
        </div>

        <div class="mb-10 p-4 bg-gray-50 rounded-md border border-gray-200">
            <h2 class="text-2xl font-semibold mb-3 text-gray-800">9. Réplication</h2>
            <p class="text-lg font-bold text-green-600">100.00%</p>
            <p class="text-gray-700">des contrôles automatisés réussis dans cette catégorie (1/1 vérifiés).</p>
            <p class="text-gray-700">3 contrôles nécessitent une vérification manuelle.</p>
            <p class="text-gray-700">0 contrôles ont rencontré une erreur d'exécution.</p>
            <p class="text-gray-700">0 contrôles ne sont pas applicables.</p>

            <table class="min-w-full border border-gray-300 divide-y divide-gray-300 mt-6">
                <thead>
                    <tr class="bg-gray-200 text-gray-700 uppercase text-sm leading-normal">
                        <th class="py-3 px-4 text-left w-1/12">Numéro</th>
                        <th class="py-3 px-4 text-left w-3/12">Recommandation</th>
                        <th class="py-3 px-4 text-left w-1/12">Type</th>
                        <th class="py-3 px-4 text-left w-2/12">Test Exécuté</th>
                        <th class="py-3 px-4 text-left w-1/12">Résultat</th>
                        <th class="py-3 px-4 text-left w-2/12">Sortie / Erreur / Notes</th>
                        <th class="py-3 px-4 text-left w-2/12">Procédure de Remédiation</th>
                    </tr>
                </thead>
                <tbody class="text-gray-600 text-sm font-light divide-y divide-gray-200">
                    
                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">9.1</td>
                        <td class="py-3 px-4 text-left align-top">Chiffrer le trafic de réplication</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Vérifier si la réplication utilise TLS (SOURCE_SSL=1) ou un tunnel VPN/SSH.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Vérifier si la réplication utilise TLS (SOURCE_SSL=1) ou un tunnel VPN/SSH.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Configurer TLS pour la réplication (SOURCE_SSL=1, SOURCE_SSL_CA, etc.) ou utiliser un tunnel sécurisé.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">9.2</td>
                        <td class="py-3 px-4 text-left align-top">SOURCE_SSL_VERIFY_SERVER_CERT = 1</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>Si TLS est utilisé, exécuter SHOW REPLICA STATUS\G et vérifier la valeur de Master_SSL_Verify_Server_Cert.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
Si TLS est utilisé, exécuter SHOW REPLICA STATUS\G et vérifier la valeur de Master_SSL_Verify_Server_Cert.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Exécuter CHANGE REPLICATION SOURCE TO SOURCE_SSL_VERIFY_SERVER_CERT = 1;</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">9.3</td>
                        <td class="py-3 px-4 text-left align-top">master_info_repository TABLE</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@master_info_repository;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-pass font-semibold">✅ Pass</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:
TABLE
Stderr:

Return Code: 0</pre></td>
                        <td class="py-3 px-4 text-left align-top">Configurer master_info_repository=TABLE dans my.cnf.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">9.4</td>
                        <td class="py-3 px-4 text-left align-top">Retirer SUPER aux comptes de réplication</td>
                        <td class="py-3 px-4 text-left align-top">Manual</td>
                        <td class="py-3 px-4 text-left align-top"><code>SHOW GRANTS FOR &#x27;&lt;repl_user&gt;&#x27;@&#x27;&lt;repl_host&gt;&#x27;; vérifier l&#x27;absence de SUPER.</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-manual font-semibold">⚠️ Manuel</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Ce contrôle nécessite une vérification manuelle.

Procédure suggérée:
SHOW GRANTS FOR &#x27;&lt;repl_user&gt;&#x27;@&#x27;&lt;repl_host&gt;&#x27;; vérifier l&#x27;absence de SUPER.</pre></td>
                        <td class="py-3 px-4 text-left align-top">REVOKE SUPER ON *.* FROM &#x27;&lt;repl_user&gt;&#x27;@&#x27;&lt;repl_host&gt;&#x27;; et accorder les privilèges dynamiques nécessaires (ex: REPLICATION_SLAVE_ADMIN).</td>
                    </tr>

                </tbody>
            </table>
        </div>

        <div class="mb-10 p-4 bg-gray-50 rounded-md border border-gray-200">
            <h2 class="text-2xl font-semibold mb-3 text-gray-800">10. InnoDB Cluster / Group Replication</h2>
            <p class="text-lg font-bold text-red-600">0.00%</p>
            <p class="text-gray-700">des contrôles automatisés réussis dans cette catégorie (0/2 vérifiés).</p>
            <p class="text-gray-700">0 contrôles nécessitent une vérification manuelle.</p>
            <p class="text-gray-700">0 contrôles ont rencontré une erreur d'exécution.</p>
            <p class="text-gray-700">0 contrôles ne sont pas applicables.</p>

            <table class="min-w-full border border-gray-300 divide-y divide-gray-300 mt-6">
                <thead>
                    <tr class="bg-gray-200 text-gray-700 uppercase text-sm leading-normal">
                        <th class="py-3 px-4 text-left w-1/12">Numéro</th>
                        <th class="py-3 px-4 text-left w-3/12">Recommandation</th>
                        <th class="py-3 px-4 text-left w-1/12">Type</th>
                        <th class="py-3 px-4 text-left w-2/12">Test Exécuté</th>
                        <th class="py-3 px-4 text-left w-1/12">Résultat</th>
                        <th class="py-3 px-4 text-left w-2/12">Sortie / Erreur / Notes</th>
                        <th class="py-3 px-4 text-left w-2/12">Procédure de Remédiation</th>
                    </tr>
                </thead>
                <tbody class="text-gray-600 text-sm font-light divide-y divide-gray-200">
                    
                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">10.1</td>
                        <td class="py-3 px-4 text-left align-top">Chiffrer le trafic Group Replication</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@group_replication_ssl_mode;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:

Stderr:
ERROR 1193 (HY000) at line 1: Unknown system variable &#x27;group_replication_ssl_mode&#x27;
Return Code: 1

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Configurer group_replication_ssl_mode à REQUIRED, VERIFY_CA, ou VERIFY_IDENTITY dans my.cnf.</td>
                    </tr>

                    <tr class="border-b border-gray-200 hover:bg-gray-100">
                        <td class="py-3 px-4 text-left align-top">10.2</td>
                        <td class="py-3 px-4 text-left align-top">Définir une allow-list de nœuds</td>
                        <td class="py-3 px-4 text-left align-top">Automated</td>
                        <td class="py-3 px-4 text-left align-top"><code>mysql -N -B -e &quot;SELECT @@group_replication_ip_allowlist;&quot;</code></td>
                        <td class="py-3 px-4 text-left align-top"><span class="status-fail font-semibold">❌ Fail</span></td>
                        <td class="py-3 px-4 text-left align-top"><pre>Stdout:

Stderr:
ERROR 1193 (HY000) at line 1: Unknown system variable &#x27;group_replication_ip_allowlist&#x27;
Return Code: 1

Condition de succès non remplie.</pre></td>
                        <td class="py-3 px-4 text-left align-top">Configurer group_replication_ip_allowlist avec les adresses IP/CIDR des nœuds autorisés.</td>
                    </tr>

                </tbody>
            </table>
        </div>

        <div class="category-chart-container" style="height: 400px;"> {/* Increased height */}
            <canvas id="categoryChart"></canvas>
        </div>


    </div>

    <script>
        // Data for the overall pie chart
        const overallChartData = {
            labels: ['Pass', 'Fail', 'Error', 'N/A'],
            datasets: [{
                label: 'Résultats des contrôles automatisés',
                data: [16, 17, 0, 0],
                backgroundColor: [
                    '#10B981', // green-500
                    '#EF4444', // red-500
                    '#6B7280', // gray-500
                    '#9CA3AF'  // gray-400
                ],
                hoverOffset: 4
            }]
        };

        // Configuration options for the overall pie chart
        const overallChartConfig = {
            type: 'pie',
            data: overallChartData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Répartition des contrôles automatisés (Global)'
                    }
                }
            }
        };

        // Render the overall chart
        const overallScoreChartCtx = document.getElementById('overallScoreChart');
        if (overallScoreChartCtx) {
             new Chart(overallScoreChartCtx, overallChartConfig);
        }


        // Data and configuration for category bar charts
        const categoryChartData = {
            labels: ["1. Configuration Syst\u00e8me d'exploitation", "2. Installation et Planification", "3. Permissions Fichiers", "4. G\u00e9n\u00e9ral", "5. Gestion des privil\u00e8ges", "6. Audit & Journalisation", "7. Authentification", "8. S\u00e9curit\u00e9 r\u00e9seau", "9. R\u00e9plication", "10. InnoDB Cluster / Group Replication"], // List of category names
            datasets: [
                {
                    label: 'Pass',
                    data: [4, 1, 1, 5, 0, 2, 2, 0, 1, 0],
                    backgroundColor: '#10B981', // green-500
                },
                {
                    label: 'Fail',
                    data: [1, 0, 1, 3, 6, 0, 3, 1, 0, 2],
                    backgroundColor: '#EF4444', // red-500
                },
                {
                    label: 'Error',
                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    backgroundColor: '#6B7280', // gray-500
                },
                 {
                    label: 'N/A',
                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    backgroundColor: '#9CA3AF', // gray-400
                }
            ]
        };

        const categoryChartConfig = {
            type: 'bar',
            data: categoryChartData,
            options: {
                responsive: true,
                maintainAspectRatio: false, // Allow chart to resize vertically
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Répartition des contrôles automatisés par catégorie'
                    }
                },
                scales: {
                    x: {
                        stacked: true,
                    },
                    y: {
                        stacked: true,
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Nombre de contrôles'
                        }
                    }
                }
            }
        };

        // Render the category bar chart
         const categoryScoreChartCtx = document.getElementById('categoryChart');
         if (categoryScoreChartCtx) {
              new Chart(categoryScoreChartCtx, categoryChartConfig);
         }

    </script>
</body>
</html>

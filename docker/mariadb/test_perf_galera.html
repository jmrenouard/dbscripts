<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tester Galera - Rapport de Performance</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap');
        body { font-family: 'Outfit', sans-serif; background-color: #0f172a; color: #f1f5f9; }
        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
    </style>
</head>
<body class="p-8">
    <div class="max-w-6xl mx-auto space-y-8">
        <header class="glass p-8 rounded-3xl flex justify-between items-center">
            <div>
                <h1 class="text-4xl font-bold bg-gradient-to-r from-cyan-400 to-blue-500 bg-clip-text text-transparent italic">
                    <i class="fa-solid fa-bolt-lightning mr-3"></i>Tester Galera
                </h1>
                <p class="text-slate-400 mt-2 font-light italic">Audit de performance du cluster Galera via HAProxy</p>
            </div>
            <div class="text-right">
                <span class="px-4 py-1 rounded-full bg-cyan-500/10 text-cyan-400 border border-cyan-500/20 text-sm font-semibold mb-2 block lowercase">Profil: light</span>
                <span class="text-slate-500 text-xs font-mono">Fri Jan  2 23:10:06 CET 2026</span>
            </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
            <!-- KPIs -->
            <div class="glass p-6 rounded-2xl">
                <div class="text-slate-500 text-xs uppercase font-bold mb-2">Throughput</div>
                <div class="text-3xl font-bold text-cyan-400">156.35 <span class="text-xs font-normal">tps</span></div>
            </div>
            <div class="glass p-6 rounded-2xl">
                <div class="text-slate-500 text-xs uppercase font-bold mb-2">Query Load</div>
                <div class="text-3xl font-bold text-blue-400">5677.65 <span class="text-xs font-normal">qps</span></div>
            </div>
            <div class="glass p-6 rounded-2xl">
                <div class="text-slate-500 text-xs uppercase font-bold mb-2">Avg Latency</div>
                <div class="text-3xl font-bold text-purple-400">25.53 <span class="text-xs font-normal text-slate-500 uppercase">ms</span></div>
            </div>
            <div class="glass p-6 rounded-2xl border-l-4 border-rose-500/50">
                <div class="text-slate-500 text-xs uppercase font-bold mb-2">Ignored Errors</div>
                <div class="text-3xl font-bold text-rose-400">1572</div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Query Metrics -->
            <div class="glass p-8 rounded-3xl">
                <h3 class="text-xl font-bold mb-6 flex items-center text-blue-400">
                    <i class="fa-solid fa-magnifying-glass-chart mr-3"></i>Query Metrics
                </h3>
                <div class="space-y-6">
                    <div>
                        <div class="flex justify-between mb-2">
                            <span class="text-slate-400 font-semibold uppercase text-xs tracking-wider">READ Queries</span>
                            <span class="text-blue-400 font-bold">43974</span>
                        </div>
                        <div class="w-full bg-slate-800 rounded-full h-2">
                            <div class="bg-blue-500 h-2 rounded-full shadow-[0_0_10px_rgba(59,130,246,0.5)]" style="width: 77.17%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between mb-2">
                            <span class="text-slate-400 font-semibold uppercase text-xs tracking-wider">WRITE Queries</span>
                            <span class="text-cyan-400 font-bold">8289</span>
                        </div>
                        <div class="w-full bg-slate-800 rounded-full h-2">
                            <div class="bg-cyan-500 h-2 rounded-full shadow-[0_0_10px_rgba(34,211,238,0.5)]" style="width: 14.54%"></div>
                        </div>
                    </div>
                    <div>
                        <div class="flex justify-between mb-2">
                            <span class="text-slate-400 font-semibold uppercase text-xs tracking-wider">OTHER Queries</span>
                            <span class="text-purple-400 font-bold">4714</span>
                        </div>
                        <div class="w-full bg-slate-800 rounded-full h-2">
                            <div class="bg-purple-500 h-2 rounded-full shadow-[0_0_10px_rgba(168,85,247,0.5)]" style="width: 8.27%"></div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Latency Profile -->
            <div class="glass p-8 rounded-3xl">
                <h3 class="text-xl font-bold mb-6 flex items-center text-cyan-400"><i class="fa-solid fa-chart-line mr-3"></i>Latency Profile (ms)</h3>
                <div class="h-64"><canvas id="latencyChart"></canvas></div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="glass p-8 rounded-3xl">
                <h3 class="text-xl font-bold mb-6 flex items-center text-amber-400"><i class="fa-solid fa-brain mr-3"></i>Conflict Intelligence</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div class="p-4 bg-amber-500/5 rounded-2xl border border-amber-500/10">
                        <div class="text-slate-500 text-[10px] uppercase font-bold mb-1">Cert. Failures</div>
                        <div class="text-2xl font-bold text-amber-400">130</div>
                    </div>
                    <div class="p-4 bg-orange-500/5 rounded-2xl border border-orange-500/10">
                        <div class="text-slate-500 text-[10px] uppercase font-bold mb-1">BF Aborts</div>
                        <div class="text-2xl font-bold text-orange-400">225</div>
                    </div>
                </div>
                <p class="mt-4 text-[10px] text-slate-400 italic">Deltas mesur√©s sur l'ensemble du cluster pendant le test.</p>
            </div>

            <div class="glass p-8 rounded-3xl">
                <h3 class="text-xl font-bold mb-6 flex items-center text-rose-400"><i class="fa-solid fa-shield-virus mr-3"></i>Cluster Logs Health</h3>
                <div class="p-4 bg-black/40 rounded-xl border border-rose-500/20 h-48 overflow-y-auto">
                    <pre class="text-[10px] text-rose-300/80 font-mono italic whitespace-pre-wrap">
--- mariadb-galera_01-1 ---
No relevant issues found.

--- mariadb-galera_02-1 ---
No relevant issues found.

--- mariadb-galera_03-1 ---
No relevant issues found.
</pre>
                </div>
            </div>
        </div>

        <details class="glass p-6 rounded-2xl text-slate-500">
            <summary class="cursor-pointer font-bold uppercase text-xs">Raw sysbench output</summary>
            <pre class="mt-4 p-4 bg-black/40 rounded text-[10px] font-mono whitespace-pre overflow-x-auto">sysbench 1.0.20 (using system LuaJIT 2.1.0-beta3)

Running the test with following options:
Number of threads: 4
Report intermediate results every 10 second(s)
Initializing random number generator from current time


Initializing worker threads...

Threads started!

[ 10s ] thds: 4 tps: 156.48 qps: 5688.50 (r/w/o: 4390.70/827.27/470.53) lat (ms,95%): 62.19 err/s: 156.78 reconn/s: 0.00
SQL statistics:
    queries performed:
        read:                            43974
        write:                           8289
        other:                           4714
        total:                           56977
    transactions:                        1569   (156.35 per sec.)
    queries:                             56977  (5677.65 per sec.)
    ignored errors:                      1572   (156.65 per sec.)
    reconnects:                          0      (0.00 per sec.)

General statistics:
    total time:                          10.0343s
    total number of events:              1569

Latency (ms):
         min:                                   11.48
         avg:                                   25.53
         max:                                  129.22
         95th percentile:                       62.19
         sum:                                40054.96

Threads fairness:
    events (avg/stddev):           392.2500/6.38
    execution time (avg/stddev):   10.0137/0.01
</pre>
        </details>
    </div>
    <script>
        new Chart(document.getElementById('latencyChart'), {
            type: 'bar',
            data: {
                labels: ['Min', 'Avg', '95th', 'Max'],
                datasets: [{
                    label: 'Latency (ms)',
                    data: [11.48, 25.53, 62.19, 129.22],
                    backgroundColor: 'rgba(34, 211, 238, 0.2)',
                    borderColor: '#22d3ee',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: true, ticks: { callback: function(value) { return value + ' ms'; } } }
                }
            }
        });
    </script>
</body>
</html>
